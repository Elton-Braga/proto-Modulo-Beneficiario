<div class="ajuste row">
  <cdk-accordion class="example-accordion col-12" [multi]="true">
    @for (item of items; track item; let index = $index) {
    <cdk-accordion-item
      #accordionItem="cdkAccordionItem"
      class="example-accordion-item"
      [expanded]="index === expandedIndex"
    >
      <button
        class="example-accordion-item-header"
        (click)="accordionItem.toggle()"
        tabindex="0"
        [attr.id]="'accordion-header-' + index"
        [attr.aria-expanded]="accordionItem.expanded"
        [attr.aria-controls]="'accordion-body-' + index"
      >
        <strong class="titulo-acordeon">{{ item }}</strong>
        <span class="example-accordion-item-description">
          Click to {{ accordionItem.expanded ? "close" : "open" }}
        </span>
      </button>
      @if (accordionItem.expanded) {
      <div
        class="example-accordion-item-body"
        role="region"
        [style.display]="accordionItem.expanded ? '' : 'none'"
        [attr.id]="'accordion-body-' + index"
        [attr.aria-labelledby]="'accordion-header-' + index"
      >
        @switch (index) { @case (0) {

        <!-- TABELA TITULAR -->
        <h3 class="titulo">Titular</h3>
        <table>
          <tr>
            <th>
              <strong>Código do Beneficiário:</strong>
              {{ beneficiario.codigo_beneficiario }}
            </th>
            <th><strong>Nome:</strong> {{ beneficiario.nome_T1 }}</th>
            <th><strong>CPF: </strong>{{ beneficiario.cpf_T1 }}</th>
            <th>
              <strong>Data de Nascimento:</strong>
              {{ beneficiario.data_nascimento }}
            </th>
          </tr>
          <tr>
            <th><strong>Telefone: </strong>{{ beneficiario.telefone }}</th>
            <th><strong>Email: </strong>{{ beneficiario.email }}</th>
            <th>
              <strong>Estado Civil: </strong>{{ beneficiario.estado_civil }}
            </th>
            <th><strong>Nome do Pai: </strong>{{ beneficiario.nome_pai }}</th>
          </tr>
          <tr>
            <th><strong>Nome da Mãe: </strong>{{ beneficiario.nome_mae }}</th>
            <th>
              <strong>Número do NIS: </strong>{{ beneficiario.numero_nis }}
            </th>
          </tr>
        </table>

        <!-- TABELA CÔNJUGE -->
        <h3 class="titulo">Cônjuge</h3>
        <table>
          <tr>
            <th><strong>Nome: </strong>{{ beneficiario.nome_T2 }}</th>
            <th><strong>CPF: </strong>{{ beneficiario.cpf_conjuge }}</th>
            <th>
              <strong>Estado Civil: </strong>{{ beneficiario.estado_civil }}
            </th>
          </tr>
          <tr>
            <th>
              <strong>Data de Homologação:</strong>
              {{ beneficiario.data_homologacao_conjuge }}
            </th>

            <th>
              <strong>Data de Homologação : </strong
              >{{ beneficiario.data_homologacao_Titular }}
            </th>
            <th></th>
          </tr>
        </table>

        <h3 class="titulo">Unidade Familiar</h3>

        <table
          *ngIf="
            beneficiario.dependentes && beneficiario.dependentes.length > 0
          "
        >
          <tr>
            <th><strong>Situação Conjugal</strong></th>
            <th><strong>Data da União</strong></th>
            <th><strong>Data da Separação</strong></th>
            <th><strong>Renda Familiar</strong></th>
            <th><strong>Nome do Dependente</strong></th>
            <th><strong>CPF do Dependente</strong></th>
          </tr>

          <ng-container
            *ngFor="let dep of beneficiario.dependentes; let i = index"
          >
            <tr>
              <!-- Exibe apenas na primeira linha -->
              <td
                *ngIf="i === 0"
                [attr.rowspan]="beneficiario.dependentes.length"
              >
                {{ dep.situacao_conjugal }}
              </td>
              <td
                *ngIf="i === 0"
                [attr.rowspan]="beneficiario.dependentes.length"
              >
                {{ dep.data_uniao }}
              </td>
              <td>{{ dep.data_separacao }}</td>
              <td
                *ngIf="i === 0"
                [attr.rowspan]="beneficiario.dependentes.length"
              >
                {{ dep.renda_familiar }}
              </td>

              <!-- Sempre exibidos -->
              <td>{{ dep.nome_dependente }}</td>
              <td>{{ dep.cpf_dependente }}</td>
            </tr>
          </ng-container>
        </table>

        <!-- Caso não tenha dependentes -->
        <p
          *ngIf="
            !beneficiario.dependentes || beneficiario.dependentes.length === 0
          "
        >
          Nenhum dependente cadastrado.
        </p>

        <h3 class="titulo">Dados do Projeto</h3>
        <table>
          <tr>
            <th>
              <strong>Código do Projeto: </strong
              >{{ beneficiario.codigo_projeto }}
            </th>
            <th><strong>Projeto: </strong>{{ beneficiario.projeto }}</th>
            <th><strong>Lote: </strong>{{ beneficiario.lote }}</th>
            <th>
              <strong>Situação: </strong
              >{{ beneficiario.historico_PNRA[0].situacao }}
            </th>
          </tr>
          <tr>
            <th>
              <strong>Número do Processo: </strong
              >{{ beneficiario.numero_processo }}
            </th>
            <th><strong>Estado: </strong>{{ beneficiario.estados }}</th>
            <th><strong>Município: </strong>{{ beneficiario.municipio }}</th>
            <th>
              <strong>Código do Município:</strong>
              {{ beneficiario.codigo_municipio }}
            </th>
          </tr>
          <tr>
            <th>
              <strong>Número do Lote: </strong>{{ beneficiario.numero_lote }}
            </th>
            <th>
              <strong>Código SNCR: </strong>{{ beneficiario.codigo_SNCR }}
            </th>
            <th>
              <strong>Denominação da Gleba:</strong>
              {{ beneficiario.denominacao_Gleba }}
            </th>
            <th>
              <strong>Denominação do Lote:</strong>
              {{ beneficiario.denominacao_lote }}
            </th>
          </tr>
          <tr>
            <th colspan="4">
              <strong>Observações: </strong>{{ beneficiario.observacao }}
            </th>
          </tr>
        </table>

        } }
      </div>
      }
    </cdk-accordion-item>
    }
  </cdk-accordion>
</div>
<div class="row ajuste nao-imprimir">
  <div class="col-1">
    <button type="button" class="btn btn-primary" (click)="fechar()">
      <strong>Voltar</strong>
    </button>
  </div>
  <div class="col-10"></div>
  <div class="col-1">
    <button type="button" class="btn btn-primary" (click)="imprimir()">
      <strong>Imprimir</strong>
    </button>
  </div>
</div>
