<div class="row margem">
  <div class="col-2"></div>
  <div class="col-3">
    <p><strong>Codigo do Beneficiario:</strong> RS0193540000456</p>
  </div>
  <div class="col-3">
    <p><strong>Titular: </strong>Joaquim José da Silva</p>
  </div>
  <div class="col-4">
    <p><strong>Projeto:</strong> RS0195000</p>
  </div>
  <div class="col-1"></div>
</div>
<div class="tela-titular">
  <div class="row align-items-center">
    <div class="col-2"><h1 class="titulo">Titular</h1></div>
    <div class="col-8"></div>
    <div class="col-1">
      <button
        type="button"
        class="btn btn-light ajuste-btn"
        [disabled]="!formgroup.valid || dependentes.length >= 1"
        (click)="adicionarDependente()"
      >
        <strong>+ Dependente</strong>
      </button>
    </div>
    <div class="col-1"></div>
  </div>

  <div class="row">
    <div class="col-12">
      <cdk-accordion class="example-accordion">
        @for (item of itemDependente; track item; let index = $index) {
        <cdk-accordion-item
          #accordionItem="cdkAccordionItem"
          class="example-accordion-item"
        >
          <button
            class="example-accordion-item-header"
            (click)="accordionItem.toggle()"
            tabindex="0"
            [attr.id]="'accordion-header-' + index"
            [attr.aria-expanded]="accordionItem.expanded"
            [attr.aria-controls]="'accordion-body-' + index"
          >
            <strong> {{ item }}</strong>
            <span class="example-accordion-item-description">
              Click para {{ accordionItem.expanded ? "Fechar" : "Abrir" }}
            </span>
          </button>
          @if(accordionItem.expanded) {
          <div
            class="example-accordion-item-body"
            role="region"
            [style.display]="accordionItem.expanded ? '' : 'none'"
            [attr.id]="'accordion-body-' + index"
            [attr.aria-labelledby]="'accordion-header-' + index"
          >
            <div *ngIf="dependentes.length > 0" class="mt-2">
              <table
                mat-table
                [dataSource]="dependentes"
                class="mat-elevation-z2 w-100 mt-3"
              >
                <!-- CPF -->
                <ng-container matColumnDef="cpf">
                  <th mat-header-cell *matHeaderCellDef>CPF</th>
                  <td mat-cell *matCellDef="let element">{{ element.cpf }}</td>
                </ng-container>

                <!-- Nome -->
                <ng-container matColumnDef="nome">
                  <th mat-header-cell *matHeaderCellDef>Nome</th>
                  <td mat-cell *matCellDef="let element">{{ element.nome }}</td>
                </ng-container>

                <!-- Apelido -->
                <ng-container matColumnDef="apelido">
                  <th mat-header-cell *matHeaderCellDef>Apelido</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.apelido }}
                  </td>
                </ng-container>

                <!-- Ações -->
                <ng-container matColumnDef="acoes">
                  <th mat-header-cell *matHeaderCellDef>Ações</th>
                  <td mat-cell *matCellDef="let element; let i = index">
                    <button
                      mat-icon-button
                      color="primary"
                      (click)="editarDependente(i)"
                    >
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button
                      mat-icon-button
                      color="warn"
                      (click)="removerDependente(i)"
                    >
                      <mat-icon>delete</mat-icon>
                    </button>
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedColumns"
                ></tr>
              </table>
            </div>
          </div>
          }
        </cdk-accordion-item>
        }
      </cdk-accordion>
    </div>
  </div>

  <form [formGroup]="formgroup">
    <div class="row espaco_campos">
      <mat-form-field class="col-4">
        <mat-label>Informe o CPF</mat-label>

        <input
          class="col-4"
          matInput
          type="text"
          mask="000.000.000-00"
          placeholder="Informe o CPF"
          formControlName="cpf"
        />
      </mat-form-field>

      <mat-form-field class="col-4">
        <mat-label>Informe o Nome</mat-label>
        <input
          class="col-4"
          matInput
          type="text"
          placeholder="Informe o nome"
          formControlName="nome"
        />
      </mat-form-field>
      <!--
      <mat-form-field class="col-4">
        <mat-label>Informe o Apelido</mat-label>
        <input
          class="col-4"
          matInput
          type="text"
          placeholder="Informe o Apelido"
          formControlName="apelido"
        />
      </mat-form-field>
    </div>
    <div class="row espaco_campos">
      <mat-form-field class="col-3">
        <mat-label>Gênero</mat-label>
        <mat-select name="food" formControlName="genero">
          @for (food of foods; track food) {
          <mat-option [value]="food.value">{{ food.viewValue }}</mat-option>
          }
        </mat-select>
      </mat-form-field>

      <mat-form-field class="example-form-field col-3">
        <mat-label>Data de nascimento</mat-label>
        <input
          matInput
          [matDatepicker]="datepicker"
          formControlName="data_nasc"
        />
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle
          matIconSuffix
          [for]="datepicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #datepicker2>
          <mat-datepicker-actions>
            <button matButton matDatepickerCancel>Cancel</button>
            <button matButton="elevated" matDatepickerApply>Apply</button>
          </mat-datepicker-actions>
        </mat-datepicker>
      </mat-form-field>

      <mat-form-field class="col-3">
        <mat-label>Estado civil</mat-label>
        <mat-select name="food" formControlName="estado_civil">
          @for (e_s of Estado_civil; track Estado_civil) {
          <mat-option [value]="e_s.value">{{ e_s.viewValue }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
      
  <mat-form-field class="example-form-field col-3">
        <mat-label>Data de Falecimento</mat-label>
        <input
          matInput
          [matDatepicker]="picker4"
          matInput
          [matDatepicker]="datepicker2"
          formControlName="data_falecimento"
        />
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle
          matIconSuffix
          [for]="picker4"
        ></mat-datepicker-toggle>
        <mat-datepicker #picker4></mat-datepicker>
      </mat-form-field>    


      <mat-form-field class="example-form-field col-3">
        <mat-label>Data de Falecimetno</mat-label>
        <input
          matInput
          [matDatepicker]="datepicker2"
          formControlName="data_falecimento"
        />
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle
          matIconSuffix
          [for]="datepicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #datepicker>
          <mat-datepicker-actions>
            <button matButton matDatepickerCancel>Cancel</button>
            <button matButton="elevated" matDatepickerApply>Apply</button>
          </mat-datepicker-actions>
        </mat-datepicker>
      </mat-form-field>-->
    </div>

    <!--<div class="row espaco_campos">
      
      <mat-form-field class="col-6">
        <mat-label>Informe o nome do Pai</mat-label>

        <input
          matInput
          type="text"
          placeholder="Informe o nome do Pai"
          formControlName="pai"
        />
      </mat-form-field>

      <mat-form-field class="col-6">
        <mat-label>Informe o nome da Mãe</mat-label>

        <input
          matInput
          type="text"
          placeholder="Informe o nome da Mãe"
          formControlName="mae"
        />
      </mat-form-field>
    </div>-->

    <!--
    <div class="row espaco_campos">
      <mat-form-field class="col-3">
        <mat-label>Nacionalidade</mat-label>
        <mat-select name="food" formControlName="nacionalidade">
          @for (pais of pais; track pais) {
          <mat-option [value]="pais.value">{{ pais.viewValue }}</mat-option>
          }
        </mat-select>
      </mat-form-field>

      <mat-form-field class="col-3">
        <mat-label>UF</mat-label>
        <mat-select
          name="uf"
          formControlName="naturalidade"
          (selectionChange)="carregarMunicipios($event.value)"
        >
          <mat-option
            *ngFor="let estado of estados; trackBy: trackByEstado"
            [value]="estado.id"
          >
            {{ estado.sigla }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field class="col-3">
        <mat-label>Município</mat-label>
        <mat-select
          (selectionChange)="atualizarCodigoMunicipio($event.value)"
          name="municipios"
          formControlName="municipio"
        >
          <mat-option
            *ngFor="let municipio of municipios; trackBy: trackByMunicipioId"
            [value]="municipio.nome"
          >
            {{ municipio.nome }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field class="col-3">
        <mat-label>Código do município</mat-label>
        <input
          matInput
          type="text"
          placeholder="Informe o Código do Município"
          [value]="codigoMunicipio"
          disabled
        />
      </mat-form-field>
    </div>-->

    <!--
    <div class="row espaco_campos">
      <mat-form-field class="col-2">
        <mat-label>Tipo de Identificação</mat-label>
        <mat-select name="food" formControlName="tipo_identificacao">
          <mat-option
            *ngFor="
              let tipo of tipo_identificacao;
              trackBy: trackByTipoIdentificacao
            "
            [value]="tipo.value"
          >
            {{ tipo.viewValue }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field class="col-2">
        <mat-label>Numero</mat-label>

        <input
          matInput
          type="text"
          placeholder="Informe o numero do Documento"
          formControlName="numero"
        />
      </mat-form-field>

      <mat-form-field class="col-2">
        <mat-label>Órgão de expedição</mat-label>

        <input
          matInput
          type="text"
          placeholder="Orgão de expedição"
          formControlName="orgao_expedicao"
        />
      </mat-form-field>

      <mat-form-field class="example-form-field col-3">
        <mat-label>Data de Expedição</mat-label>
        <input
          matInput
          [matDatepicker]="datepicker3"
          formControlName="data_expedicao"
        />
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle
          matIconSuffix
          [for]="datepicker3"
        ></mat-datepicker-toggle>
        <mat-datepicker #datepicker3>
          <mat-datepicker-actions>
            <button matButton matDatepickerCancel>Cancel</button>
            <button matButton="elevated" matDatepickerApply>Apply</button>
          </mat-datepicker-actions>
        </mat-datepicker>
      </mat-form-field>

      <mat-form-field class="col-3">
        <mat-label>Numero do NIS</mat-label>

        <input matInput type="text" placeholder="NIS" formControlName="nis" />
      </mat-form-field>
    </div>-->

    <!--
    <div class="row espaco_campos">
      <mat-form-field class="col-6">
        <mat-label>Telefone</mat-label>

        <input
          matInput
          type="tel"
          placeholder="Informe o telefone"
          mask="(00) 00000-0000"
          formControlName="telefone"
        />
      </mat-form-field>

      <mat-form-field class="col-6">
        <mat-label>Email</mat-label>

        <input
          matInput
          type="email"
          placeholder="Informe o Email"
          formControlName="email"
        />
      </mat-form-field>
    </div> -->
    <div class="row espaco_campos">
      <mat-form-field class="col-11">
        <mat-label>Numero do Processo</mat-label>

        <input
          matInput
          type="tel"
          placeholder="Informe o numero do processo"
          mask="000000000/0000"
          formControlName="numero_processo"
        />
      </mat-form-field>
      <div
        class="col-1 flex justify-center col-auto d-inline-flex align-items-center text-right text-end ajuste_plus"
      >
        <button
          type="button"
          class="btn btn-primary"
          [disabled]="
            formgroup.get('numero_processo')?.invalid ||
            !formgroup.get('numero_processo')?.value
          "
          (click)="adicionarProcesso()"
        >
          Novo Processo
        </button>
      </div>
    </div>
  </form>
  <div class="row">
    <div class="col-12">
      <cdk-accordion class="example-accordion">
        @for (item of items; track item; let index = $index) {
        <cdk-accordion-item
          #accordionItem="cdkAccordionItem"
          class="example-accordion-item"
        >
          <button
            class="example-accordion-item-header"
            (click)="accordionItem.toggle()"
            tabindex="0"
            [attr.id]="'accordion-header-' + index"
            [attr.aria-expanded]="accordionItem.expanded"
            [attr.aria-controls]="'accordion-body-' + index"
          >
            <strong>{{ item }}</strong>
            <span class="example-accordion-item-description">
              Click para {{ accordionItem.expanded ? "Fechar" : "Abrir" }}
            </span>
          </button>
          @if(accordionItem.expanded) {
          <div
            class="example-accordion-item-body"
            role="region"
            [style.display]="accordionItem.expanded ? '' : 'none'"
            [attr.id]="'accordion-body-' + index"
            [attr.aria-labelledby]="'accordion-header-' + index"
          >
            <div *ngIf="processos.length > 0" class="mt-2">
              <table class="tabela-processos">
                <tr class="linha-titulo">
                  <th><p class="titulo-tabela">Processos adicionados</p></th>
                  <th>Ações</th>
                </tr>
                <tr *ngFor="let p of processos">
                  <td class="celula-dados">
                    <p class="dado">{{ p | numeroProcessoSei }}</p>
                  </td>
                  <td>...</td>
                </tr>
              </table>
            </div>
          </div>
          }
        </cdk-accordion-item>
        }
      </cdk-accordion>
    </div>
  </div>

  <div class="col-1 ajuste-btn-salvar">
    <button type="button" class="btn btn-primary">Salvar</button>
  </div>
</div>
<!--
<app-unidade-familar></app-unidade-familar>-->
